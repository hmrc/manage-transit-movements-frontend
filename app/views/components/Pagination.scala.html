@*
 * Copyright 2022 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import viewModels.pagination._

@this()

@(
    viewModel: PaginationViewModel
)(implicit messages: Messages)

@resultsCountMessage = {
    @viewModel.results.count match {
        case 1 => { @Html(messages("numberOfMovements.singular", "<b>1</b>")) }
        case x => { @Html(messages("numberOfMovements.plural", s"<b>$x</b>")) }
        case _ => { () }
    }
}

@if(viewModel.results.totalPages == 1) {
    <p id="results-count" class="govuk-body">@resultsCountMessage</p>
} else if(viewModel.results.totalPages > 1) {
    <nav class="pagination" aria-label=@messages("pagination.searchResults")>
        <div class="pagination__list">

            <p id="paginated-results-count" class="pagination__results">
                @Html(messages("pagination.results", s"<b>${viewModel.results.from}</b>", s"<b>${viewModel.results.to}</b>", s"<b>${viewModel.results.count}</b>"))
            </p>

            @viewModel.previous.map { p =>
                <span class="pagination__item pagination__item--prev" >
                    <a id="previous" class="pagination__link" href=@p.href>
                        <span aria-hidden="true">@messages("pagination.previous")</span>
                        <span class="govuk-visually-hidden">@messages("pagination.previous.hidden")</span>
                    </a>
                 </span>
            }

            @for((item, index) <- viewModel.items.items.zip(Stream from 1)) {
                @if(viewModel.items.lastItemDotted && index == viewModel.items.items.length) {
                    <span class="pagination__item pagination__item--dots" aria-hidden="true">@messages("pagination.ellipses")</span>
                    <span class="govuk-visually-hidden">@messages("pagination.ellipses.hidden")</span>
                }

                @if(item.selected) {
                    <span id="pagination-item-@item.pageNumber" class="pagination__item pagination__item--active" aria-current="page">
                        @item.pageNumber
                    </span>
                } else {
                    <span id="pagination-item-@item.pageNumber" class="pagination__item">
                        <a class="pagination__link" href=@item.href>
                            <span aria-hidden="true">@item.pageNumber</span>
                            <span class="govuk-visually-hidden">@messages("pagination.page", item.pageNumber)</span>
                        </a>
                    </span>
                }

                @if(viewModel.items.firstItemDotted && index == 1) {
                    <span class="pagination__item pagination__item--dots" aria-hidden="true">@messages("pagination.ellipses")</span>
                    <span class="govuk-visually-hidden">@messages("pagination.ellipses.hidden")</span>
                }
            }

            @viewModel.next.map { n =>
                <span class="pagination__item  pagination__item--next" >
                    <a id="next" class="pagination__link" href=@n.href>
                        <span aria-hidden="true">@messages("pagination.next")</span>
                        <span class="govuk-visually-hidden">@messages("pagination.next.hidden")</span>
                    </a>
                </span>
            }

        </div>
    </nav>
}